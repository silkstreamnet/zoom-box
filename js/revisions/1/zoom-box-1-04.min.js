!function(j){var l={boxWidth:"auto",boxHeight:"auto",boxLeft:"auto",boxTop:"auto",imageSource:"auto",appendBoxTo:"body",fitBoxTo:window,alignBoxTo:window,boxId:"",boxClass:"",position:"fixed",closeText:"",delegate:"",onUpdateScale:!1},f=[];function c(o,t){var e=o.attr(t);return void 0===e?"":e}function d(o,t){if(o.zbobj){"function"==typeof t.onUpdateScale&&t.onUpdateScale(t);var e=j("body"),i=!1;if(t.fitBoxTo==window&&(t.position="fixed")){i=!0;var n=e.width();e.css("overflow","hidden");var a=e.width();if(n<a){var s=parseInt(e.css("margin-right"))+(a-n);e.css("margin-right",s+"px")}}o.zbobj.css({top:"0",left:"0"}),"string"==typeof t.boxClass&&""!=t.boxClass&&o.zbobj.addClass(t.boxClass),"string"==typeof t.boxId&&""!=t.boxId&&o.zbobj.attr("id",t.boxId);var r=t.boxWidth,b=t.boxHeight,l=t.boxLeft,f=t.boxTop;"not set"!=r&&("auto"==r?(r=t.fitBoxTo==window?o.relativeFit.width():o.relativeFit.outerWidth(!1),o.zbobj.width(r)):"string"==typeof r&&r.match(/[0-9]{1,2}%/)?o.zbobj.css("width",r):o.zbobj.width(parseFloat(r))),"not set"!=b&&("auto"==b?(b=t.fitBoxTo==window?o.relativeFit.height():o.relativeFit.outerHeight(!1),o.zbobj.height(b)):"string"==typeof b&&b.match(/[0-9]{1,2}%/)?o.zbobj.css("height",b):o.zbobj.height(parseFloat(b)));var c=o.zbobj.offset(),d=o.relativeAlign?o.relativeAlign.offset():0;"not set"!=l?"auto"==l?(l=t.alignBoxTo==window?"fixed"!=t.position&&0<c.left?-c.left:0:c.left==d.left?0:c.left>d.left?0-(c.left-d.left):d.left-c.left,o.zbobj.css("left",l+"px")):"string"==typeof l&&l.match(/[0-9]{1,2}%/)?o.zbobj.css("left",l):o.zbobj.css("left",parseFloat(l)+"px"):o.zbobj.css("left",""),"not set"!=f?"auto"==f?(f=t.alignBoxTo==window?"fixed"!=t.position&&0<c.top?-c.top:0:c.top==d.top?0:c.top>d.top?0-(c.top-d.top):d.top-c.top,o.zbobj.css("top",f+"px")):"string"==typeof f&&f.match(/[0-9]{1,2}%/)?o.zbobj.css("top",f):o.zbobj.css("top",parseFloat(f)+"px"):o.zbobj.css("top","");var g=t.naturalImgWidth,u=t.naturalImgHeight,m=o.zbobj.width(),h=o.zbobj.height(),p=g/m,v=u/h,z=g,x=u;(v<1||p<1)&&(p<v?x*=(z=m)/g:z*=(x=h)/u),o.zbimg.width(z),o.zbimg.height(x),i&&"fixed"!=t.position&&e.css("overflow",t.defaultBodyOverflow);var w=o.zbobj.offset();t.mouseX=w.left+o.zbobj.width()/2,t.mouseY=w.top+o.zbobj.height()/2,T(o,t)}}function T(o,t){o.zbobj&&t&&!1===t.animator.timer&&function o(t,e){var i=e.timeoutSpeed,n=t.zbobj.width(),a=t.zbobj.height(),s=t.zbimg.width(),r=t.zbimg.height(),b=t.zbobj.offset(),l=t.zbimg.offset(),f=-1*(e.mouseX-b.left)/n*(s-n),c=-1*(e.mouseY-b.top)/a*(r-a);e.invert&&(f=-1*(s-n)+Math.abs(f),c=-1*(r-a)+Math.abs(c));var d=s==n?0:-1*(s-n);0<=f?f=0:f<d&&(f=d);var g=r==a?0:-1*(r-a);0<=c?c=0:c<g&&(c=g);var u=parseFloat(l.left-b.left),m=parseFloat(l.top-b.top),h=u,p=m;if(f!=u){var v=f-u,z=.2*(f-u);v<1&&-1<v&&(z=v),h=Math.floor(10*(u+z))/10,t.zbimg.css("left",h+"px")}if(c!=m){var x=c-m,w=.2*(c-m);x<1&&-1<x&&(w=x),p=Math.floor(10*(m+w))/10,t.zbimg.css("top",p+"px")}!1!==e.animator.timer&&(clearTimeout(e.animator.timer),e.animator.timer=!1),!1!==e.animator.timer||u==f&&m==c||(e.animator.timer=setTimeout(function(){o(t,e)},i))}(o,t)}function g(o,t){var e=j("body");t.defaultBodyOverflow=e.css("overflow"),t.defaultMarginRight=e.css("margin-right");var i=t.zbid,n=function(o){var t={src:"",width:0,height:0},e=o;if(t.src=c(e,"src"),!t.src){var i=o.find("img");0<i.length&&(e=i.eq(0),t.src=c(e,"src"))}return t.src&&(t.width=e.width(),t.height=e.height()),t}(o),a=n.src;t.naturalImgWidth=n.width,t.naturalImgHeight=n.height;var s='<div class="zoom-box-container" data-zbid="'+i+'"><a href="javascript:void(0);" class="zoom-box-close">'+("string"==typeof t.closeText?t.closeText:"")+'</a><img src="'+a+'" alt="" /></div>',r={relativeHolder:"object"==typeof t.appendBoxTo&&t.appendBoxTo!=window?t.appendBoxTo:j(t.appendBoxTo),relativeFit:"object"==typeof t.fitBoxTo&&t.fitBoxTo!=window||!t.fitBoxTo?t.fitBoxTo:j(t.fitBoxTo),relativeAlign:"object"==typeof t.alignBoxTo&&t.alignBoxTo!=window||!t.alignBoxTo?t.alignBoxTo:j(t.alignBoxTo)};if(r.relativeHolder.length){var b=!1;r.relativeHolder=r.relativeHolder.eq(0),r.relativeHolder.append(s),r.zbobj=r.relativeHolder.find('.zoom-box-container[data-zbid="'+i+'"]'),r.zbimg=r.zbobj.find("img"),r.zbclose=r.zbobj.find("a.zoom-box-close"),r.zbobj.css({position:t.position,"z-index":"990",visibility:"hidden"}),r.zbimg.css({position:"absolute","z-index":"991","max-width":"none","max-height":"none"}),r.zbclose.css({position:"absolute","z-index":"992"}),d(r,t),r.zbobj.css({visibility:"visible",overflow:"hidden",display:"none"}).fadeIn(400,function(){setTimeout(function(){b=!0},100)}),r.zbimg.on("dragstart",function(o){o.preventDefault()}),r.zbobj.on("mousemove",function(o){b&&(t.mouseX=o.pageX,t.mouseY=o.pageY,t.invert=!1,T(r,t))}).on("touchmove",function(o){o.preventDefault(),b&&(t.mouseX=o.originalEvent.touches[0].pageX,t.mouseY=o.originalEvent.touches[0].pageY,t.invert=!0,T(r,t))}).on("mousedown",function(o){o.preventDefault(),t.mouseDownX=o.pageX,t.mouseDownY=o.pageY}).on("mouseup",function(o){o.preventDefault();o.pageX<=t.mouseDownX+5&&o.pageX>=t.mouseDownX-5&&o.pageY<=t.mouseDownY+5&&o.pageY>=t.mouseDownY-5&&u(r,t),t.mouseDownX=-999,t.mouseDownY=-999}),r.zbclose.click(function(o){o.preventDefault(),u(r,t)}),f[i-1].zbobjects=r,t._imageSource="auto"==t.imageSource?c(o,"href"):t.imageSource,function(o,t){if(t.naturalImgWidth=0,t.naturalImgHeight=0,t._imageSource){var e=new Image;e.src=t._imageSource,setTimeout(function(){e.complete?(t.naturalImgWidth=e.width,t.naturalImgHeight=e.height,o.zbimg.attr("src",t._imageSource),d(o,t)):e.onload=function(){t.naturalImgWidth=this.width,t.naturalImgHeight=this.height,o.zbimg.attr("src",t._imageSource),d(o,t)}},1)}}(r,t),t.isopen=!0}else t.isopen=!1}function u(o,t){t.isopen&&(o.zbobj.fadeOut(400,function(){o.zbobj.remove(),o={},delete f[t.zbid-1].zbobjects,!1!==t.animator.timer&&(clearTimeout(t.animator.timer),t.animator.timer=!1),j("body").css({overflow:t.defaultBodyOverflow,"margin-right":t.defaultMarginRight})}),t.isopen=!1)}var t=!(j.fn.ZoomBox=function(o){o=o||{};var t=j.extend({},l,o);!function(o,a){if(0<o.length){var t=j("body"),s=t.css("overflow"),r=t.css("margin-right"),b=Math.round(1e3/30);o.each(function(){var o,t,e=j(this),i="string"==typeof a.delegate?a.delegate:"",n=j.extend({},a);!function(o,t){for(var e in l)if(l.hasOwnProperty(e)){var i=c(o,"data-"+e.toLowerCase());i&&(t[e]=i)}}(e,n),o=e,(t=n).zbid=f.length+1,t.animator={timer:!1,startTime:0},f.push({object:o,settings:t}),n.isopen=!1,n.defaultBodyOverflow=s,n.defaultMarginRight=r,n.timeoutSpeed=b,n.mouseX=0,n.mouseY=0,n.mouseDownX=-999,n.mouseDownY=-999,n.invert=!1,i?e.on("click",i,function(o){o.preventDefault(),n.isopen||g(j(this),n)}):e.on("click",function(o){o.preventDefault(),n.isopen||g(j(this),n)})})}}(j(this),t)});j(window).on("resize.zoombox",function(){0==t&&(t=!0,setTimeout(function(){for(var o=0;o<f.length;o++)void 0!==f[o].zbobjects&&d(f[o].zbobjects,f[o].settings);t=!1},100))});var e=!1;j(window).on("scroll.zoombox",function(){if(0==e){for(var o=0;o<f.length;o++)void 0!==f[o].zbobjects&&d(f[o].zbobjects,f[o].settings);e=!0,setTimeout(function(){for(var o=0;o<f.length;o++)void 0!==f[o].zbobjects&&d(f[o].zbobjects,f[o].settings);e=!1},10)}})}(jQuery);