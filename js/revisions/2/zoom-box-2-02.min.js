!function(s){var u=.2,h=1,c=.2,f=5,r={renderContainer:!1,renderOverImage:!0,renderWidth:!1,renderHeight:!1,zoomSrc:"",closeText:"",imageClickClose:!1,refreshRate:30,fadeDuration:400,onRemove:!1,afterRemove:!1,onCreate:!1,afterCreate:!1},a=0,m=[];function d(o,e,t,n,r){var i=n.$zoombox.width(),a=n.$zoombox.height();n.moveready=!0,n.naturalImgWidth=e,n.naturalImgHeight=t,n.$zoomboxImage.attr("src",o),p(n,r),n.$zoomboxImage.css("left",(i-n.$zoomboxImage.width())/2+"px"),n.$zoomboxImage.css("top",(a-n.$zoomboxImage.height())/2+"px"),n.mouseX=i/2,n.mouseY=a/2,n.$zoombox.trigger("mousemove")}function g(o,e){var t=o.attr(e);return void 0===t?"":t}function l(o,e){for(var t in r)if(r.hasOwnProperty(t)){var n=g(o,"data-"+t.toLowerCase());n&&(e[t]="false"!==n&&n)}}function p(o,e){var t=!1!==e.renderWidth?e.renderWidth:"100%",n=!1!==e.renderHeight?e.renderHeight:"100%";if(e.renderOverImage)o.$mousetrap.css({width:"100%",height:"100%"});else{var r=o.$oimage.width(),i=o.$oimage.height(),a=o.$oimage.parent().width(),m=o.$oimage.parent().height();r<a?o.$mousetrap.width(r):o.$mousetrap.width(a),i<m?o.$mousetrap.height(i):o.$mousetrap.height(m)}"string"==typeof t&&t.match(/[0-9]{1,3}%/)?o.$zoombox.css("width",t):"number"==typeof t&&o.$zoombox.width(t),"string"==typeof n&&n.match(/[0-9]{1,3}%/)?o.$zoombox.css("height",n):"number"==typeof n&&o.$zoombox.height(n);var s=o.naturalImgWidth,u=o.naturalImgHeight,h=o.$zoombox.width(),c=o.$zoombox.height(),f=s/h,d=u/c,g=s,l=u;(d<1||f<1)&&(f<d?l*=(g=h)/s:g*=(l=c)/u),o.$zoomboxImage.width(g),o.$zoomboxImage.height(l),$(o,e)}function $(o,e){!1===o.animator.timer&&function o(e,t){var n=e.timeoutSpeed,r=e.$zoombox.width(),i=e.$zoombox.height(),a=e.$zoomboxImage.width(),m=e.$zoomboxImage.height(),s=e.$zoomboxImage.position(),u=-1*e.mouseX/r*(a-r),h=-1*e.mouseY/i*(m-i);e.invert&&(u=-1*(a-r)+Math.abs(u),h=-1*(m-i)+Math.abs(h));var c=a==r?0:-1*(a-r);0<u?u=0:u<c&&(u=c);var f=m==i?0:-1*(m-i);0<h?h=0:h<f&&(h=f);var d=parseFloat(s.left),g=parseFloat(s.top),l=d,p=g,$=e.latency;if(u!=d){var v=u-d,b=(u-d)*$;v<1&&-1<v&&(b=v),l=Math.floor(10*(d+b))/10,e.$zoomboxImage.css("left",l+"px")}if(h!=g){var x=h-g,z=(h-g)*$;x<1&&-1<x&&(z=x),p=Math.floor(10*(g+z))/10,e.$zoomboxImage.css("top",p+"px")}!1!==e.animator.timer&&(clearTimeout(e.animator.timer),e.animator.timer=!1),!1!==e.animator.timer||d==u&&g==h||(e.animator.timer=setTimeout(function(){o(e,t)},n))}(o,e)}function v(o,e){o.isopen&&("function"==typeof e.onRemove&&e.onRemove(e),o.isopen=!1,o.$zoombox.fadeOut(e.fadeDuration,function(){o.$zoombox.remove(),o.$mousetrap.remove(),!1!==o.animator.timer&&(clearTimeout(o.animator.timer),o.animator.timer=!1),o.$sobjects.attr("data-zbid",""),"function"==typeof e.afterRemove&&e.afterRemove(e)}))}function o(){for(var o in m)if(m.hasOwnProperty(o)&&m[o]&&m[o].length)for(var e=0;e<m[o].length;e++)p(m[o][e].controllers,m[o][e].settings)}var e=!(s.fn.ZoomBox=function(o){o=o||{};var e=s(this);if("string"==typeof o){var t=g(e,"data-zbid");if(t&&m[t]&&0<m[t].length)for(var n=0;n<m[t].length;n++)switch(o){default:break;case"remove":v(m[t][n].controllers,m[t][n].settings),n==m[t].length&&delete m[t]}}else{!function(r,t){if(0<r.length){var e=-1;if(r.each(function(){var o=g(s(this),"data-zbid");""!==o&&(e=parseInt(o))}),0<=e&&m[e]&&0<m[e].length)for(var o=0;o<m[e].length;o++)m[e][o].controllers.isopen||(m[e][o].controllers.$zoombox.stop(!0,!1).fadeTo(t.fadeDuration,1),m[e][o].controllers.isopen=!0);else{var i=Math.round(1e3/t.refreshRate);m[++a]=[],r.attr("data-zbid",a),r.each(function(){var o=s(this),n=s.extend({},t);l(o,n);var e=o;g(o,"src")||(e=o.find("img")),e.each(function(){var o=s(this),e=s.extend({},n);l(o,e);var t={id:a,$sobjects:r,$oimage:o,$oimageContainer:o.parent(),$renderContainer:!1,$zoombox:!1,$zoomboxImage:!1,$zoomboxClose:!1,$mousetrap:!1,originalSrc:"",renderOverImage:!1,isopen:!1,naturalImgWidth:0,naturalImgHeight:0,timeoutSpeed:i,mouseX:0,mouseY:0,mouseDownX:-999,mouseDownY:-999,touchX:-999,touchY:-999,touchDiffX:0,touchDiffY:0,invert:!1,moveready:!1,latency:.2,animator:{timer:!1,startTime:0}};!function(a,m){"function"==typeof m.onCreate&&m.onCreate(m);var o=function(o){var e={src:"",width:0,height:0};o&&o.length&&(e.src=g(o,"src"),e.src&&(e.width=o.width(),e.height=o.height()));return e}(a.$oimage);a.originalSrc=o.src,a.naturalImgWidth=o.width,a.naturalImgHeight=o.height;var e='<div class="zoom-box-container"><a href="javascript:void(0);" class="zoom-box-close">'+("string"==typeof m.closeText?m.closeText:"")+'</a><img class="zoom-box-image" src="'+a.originalSrc+'" alt="" /></div>',t='<div class="zoom-box-mousetrap"></div>';a.$renderContainer=!m.renderContainer||"object"==typeof m.renderContainer&&m.renderContainer!=window?m.renderContainer:s(m.renderContainer),a.$renderContainer&&a.$renderContainer.length||(a.$renderContainer=a.$oimageContainer);a.$renderContainer&&a.$renderContainer.length?(1<a.$renderContainer.length&&(a.$renderContainer=a.$renderContainer.eq(0)),a.$renderContainer.prepend(e),m.renderOverImage?(a.$renderContainer.prepend(t),a.$mousetrap=a.$renderContainer.find(".zoom-box-mousetrap")):(a.$oimage.before(t),a.$mousetrap=a.$oimageContainer.find(".zoom-box-mousetrap")),a.$zoombox=a.$renderContainer.find(".zoom-box-container"),a.$zoomboxImage=a.$zoombox.find(".zoom-box-image"),a.$zoomboxClose=a.$zoombox.find(".zoom-box-close"),a.$zoombox.css({position:"absolute","z-index":"90",visibility:"hidden",display:"block"}),a.$zoomboxImage.css({position:"absolute","z-index":"91","max-width":"none","max-height":"none",display:"block"}),a.$zoomboxClose.css({position:"absolute","z-index":"92"}),a.$mousetrap.css({position:"absolute","z-index":"93",display:"block"}),p(a,m),a.$zoombox.css({visibility:"visible",overflow:"hidden",opacity:0}).animate({opacity:1},m.fadeDuration),a.$zoomboxImage.on("dragstart",function(o){o.preventDefault()}),a.$mousetrap.on("mousemove",function(o){if(a.moveready){a.invert=!1,a.latency=u;var e=a.$zoombox.offset();a.mouseX=o.pageX-e.left,a.mouseY=o.pageY-e.top,$(a,m)}}).on("touchmove",function(o){if(o.preventDefault(),a.moveready){a.invert=!0,a.latency=h;var e=a.$zoombox.offset(),t=o.originalEvent.touches[0].pageX-e.left,n=o.originalEvent.touches[0].pageY-e.top;if(0<=a.touchX&&0<=a.touchY){var r=a.$mousetrap.width(),i=a.$mousetrap.height();a.touchDiffX=t-a.touchX,a.touchDiffY=n-a.touchY,a.mouseX+=a.touchDiffX,a.mouseY+=a.touchDiffY,a.mouseX>r?a.mouseX=r:a.mouseX<0&&(a.mouseX=0),a.mouseY>i?a.mouseY=i:a.mouseY<0&&(a.mouseY=0),$(a,m)}a.touchX=t,a.touchY=n}}).on("mousedown",function(o){o.preventDefault();var e=a.$zoombox.offset();a.mouseDownX=o.pageX-e.left,a.mouseDownY=o.pageY-e.top}).on("mouseup",function(o){if(o.preventDefault(),m.imageClickClose){var e=a.$zoombox.offset();o.pageX-e.left<=a.mouseDownX+5&&o.pageX-e.left>=a.mouseDownX-5&&o.pageY-e.top<=a.mouseDownY+5&&o.pageY-e.top>=a.mouseDownY-5&&v(a,m)}a.mouseDownX=-999,a.mouseDownY=-999}).on("touchend",function(o){if(a.invert=!0,a.latency=c,0<=a.touchX&&0<=a.touchY){var e=a.$mousetrap.width(),t=a.$mousetrap.height(),n=Math.abs(a.touchDiffX),r=Math.abs(a.touchDiffY);f<=n&&(a.mouseX+=a.touchDiffX*f,a.mouseX>e?a.mouseX=e:a.mouseX<0&&(a.mouseX=0)),f<=r&&(a.mouseY+=a.touchDiffY*f,a.mouseY>t?a.mouseY=t:a.mouseY<0&&(a.mouseY=0)),$(a,m)}a.touchX=-999,a.touchY=-999}),a.$zoomboxClose.click(function(o){o.preventDefault(),v(a,m)}),function(o,e){var t=e.zoomSrc?e.zoomSrc:o.originalSrc;if(t){var n=new Image;n.src=t,setTimeout(function(){n.complete?d(t,n.width,n.height,o,e):n.onload=function(){d(t,this.width,this.height,o,e)}},1)}}(a,m),a.isopen=!0,"function"==typeof m.afterCreate&&m.afterCreate(m)):a.isopen=!1}(t,e),m[a].push({controllers:t,settings:e})})})}}}(e,s.extend({},r,o))}});s(window).on("resize.zoombox",function(){0==e&&(e=!0,setTimeout(function(){o(),e=!1},100))});var t=!1;s(window).on("scroll.zoombox",function(){0==t&&(o(),t=!0,setTimeout(function(){o(),t=!1},10))})}(jQuery);