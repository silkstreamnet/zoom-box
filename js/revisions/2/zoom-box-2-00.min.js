!function(s){var u=.2,h=1,r={renderContainer:!1,renderOverImage:!0,renderWidth:!1,renderHeight:!1,zoomSrc:"",closeText:"",imageClickClose:!1,refreshRate:30,fadeDuration:400,onRemove:!1,afterRemove:!1,onCreate:!1,afterCreate:!1},a=0,m=[];function c(o,e,t,n,r){var i=n.$zoombox.width(),a=n.$zoombox.height();n.moveready=!0,n.naturalImgWidth=e,n.naturalImgHeight=t,n.$zoomboxImage.attr("src",o),g(n,r),n.$zoomboxImage.css("left",(i-n.$zoomboxImage.width())/2+"px"),n.$zoomboxImage.css("top",(a-n.$zoomboxImage.height())/2+"px"),n.mouseX=i/2,n.mouseY=a/2,n.$zoombox.trigger("mousemove")}function d(o,e){var t=o.attr(e);return void 0===t?"":t}function f(o,e){for(var t in r)if(r.hasOwnProperty(t)){var n=d(o,"data-"+t.toLowerCase());n&&(e[t]="false"!==n&&n)}}function g(o,e){var t=!1!==e.renderWidth?e.renderWidth:"100%",n=!1!==e.renderHeight?e.renderHeight:"100%";if(e.renderOverImage)o.$mousetrap.css({width:"100%",height:"100%"});else{var r=o.$oimage.width(),i=o.$oimage.height(),a=o.$oimage.parent().width(),m=o.$oimage.parent().height();r<a?o.$mousetrap.width(r):o.$mousetrap.width(a),i<m?o.$mousetrap.height(i):o.$mousetrap.height(m)}"string"==typeof t&&t.match(/[0-9]{1,3}%/)?o.$zoombox.css("width",t):"number"==typeof t&&o.$zoombox.width(t),"string"==typeof n&&n.match(/[0-9]{1,3}%/)?o.$zoombox.css("height",n):"number"==typeof n&&o.$zoombox.height(n);var s=o.naturalImgWidth,u=o.naturalImgHeight,h=o.$zoombox.width(),c=o.$zoombox.height(),d=s/h,f=u/c,g=s,l=u;(f<1||d<1)&&(d<f?l*=(g=h)/s:g*=(l=c)/u),o.$zoomboxImage.width(g),o.$zoomboxImage.height(l),p(o,e)}function p(o,e){!1===o.animator.timer&&function o(e,t){var n=e.timeoutSpeed,r=e.$zoombox.width(),i=e.$zoombox.height(),a=e.$zoomboxImage.width(),m=e.$zoomboxImage.height(),s=e.$zoomboxImage.position(),u=-1*e.mouseX/r*(a-r),h=-1*e.mouseY/i*(m-i);e.invert&&(u=-1*(a-r)+Math.abs(u),h=-1*(m-i)+Math.abs(h));var c=a==r?0:-1*(a-r);0<u?u=0:u<c&&(u=c);var d=m==i?0:-1*(m-i);0<h?h=0:h<d&&(h=d);var f=parseFloat(s.left),g=parseFloat(s.top),l=f,p=g,$=e.latency;if(u!=f){var v=u-f,b=(u-f)*$;v<1&&-1<v&&(b=v),l=Math.floor(10*(f+b))/10,e.$zoomboxImage.css("left",l+"px")}if(h!=g){var x=h-g,z=(h-g)*$;x<1&&-1<x&&(z=x),p=Math.floor(10*(g+z))/10,e.$zoomboxImage.css("top",p+"px")}!1!==e.animator.timer&&(clearTimeout(e.animator.timer),e.animator.timer=!1),!1!==e.animator.timer||f==u&&g==h||(e.animator.timer=setTimeout(function(){o(e,t)},n))}(o,e)}function l(o,e){o.isopen&&("function"==typeof e.onRemove&&e.onRemove(e),o.isopen=!1,o.$zoombox.fadeOut(e.fadeDuration,function(){o.$zoombox.remove(),o.$mousetrap.remove(),!1!==o.animator.timer&&(clearTimeout(o.animator.timer),o.animator.timer=!1),o.$sobjects.attr("data-zbid",""),"function"==typeof e.afterRemove&&e.afterRemove(e)}))}function o(){for(var o in m)if(m.hasOwnProperty(o)&&m[o]&&m[o].length)for(var e=0;e<m[o].length;e++)g(m[o][e].controllers,m[o][e].settings)}var e=!(s.fn.ZoomBox=function(o){o=o||{};var e=s(this);if("string"==typeof o){var t=d(e,"data-zbid");if(t&&m[t]&&0<m[t].length)for(var n=0;n<m[t].length;n++)switch(o){default:break;case"remove":l(m[t][n].controllers,m[t][n].settings),n==m[t].length&&delete m[t]}}else{!function(r,t){if(0<r.length){var e=-1;if(r.each(function(){var o=d(s(this),"data-zbid");""!==o&&(e=parseInt(o))}),0<=e&&m[e]&&0<m[e].length)for(var o=0;o<m[e].length;o++)m[e][o].controllers.isopen||(m[e][o].controllers.$zoombox.stop(!0,!1).fadeTo(t.fadeDuration,1),m[e][o].controllers.isopen=!0);else{var i=Math.round(1e3/t.refreshRate);m[++a]=[],r.attr("data-zbid",a),r.each(function(){var o=s(this),n=s.extend({},t);f(o,n);var e=o;d(o,"src")||(e=o.find("img")),e.each(function(){var o=s(this),e=s.extend({},n);f(o,e);var t={id:a,$sobjects:r,$oimage:o,$oimageContainer:o.parent(),$renderContainer:!1,$zoombox:!1,$zoomboxImage:!1,$zoomboxClose:!1,$mousetrap:!1,originalSrc:"",renderOverImage:!1,isopen:!1,naturalImgWidth:0,naturalImgHeight:0,timeoutSpeed:i,mouseX:0,mouseY:0,mouseDownX:-999,mouseDownY:-999,touchX:-999,touchY:-999,invert:!1,moveready:!1,latency:.2,animator:{timer:!1,startTime:0}};!function(a,m){"function"==typeof m.onCreate&&m.onCreate(m);var o=function(o){var e={src:"",width:0,height:0};o&&o.length&&(e.src=d(o,"src"),e.src&&(e.width=o.width(),e.height=o.height()));return e}(a.$oimage);a.originalSrc=o.src,a.naturalImgWidth=o.width,a.naturalImgHeight=o.height;var e="string"==typeof m.closeText?m.closeText:"",t='<div class="zoom-box-container"><img class="zoom-box-image" src="'+a.originalSrc+'" alt="" /></div><a href="javascript:void(0);" class="zoom-box-close">'+e+"</a>",n='<div class="zoom-box-mousetrap"></div>';a.$renderContainer=!m.renderContainer||"object"==typeof m.renderContainer&&m.renderContainer!=window?m.renderContainer:s(m.renderContainer),a.$renderContainer&&a.$renderContainer.length||(a.$renderContainer=a.$oimageContainer);a.$renderContainer&&a.$renderContainer.length?(1<a.$renderContainer.length&&(a.$renderContainer=a.$renderContainer.eq(0)),a.$renderContainer.prepend(t),m.renderOverImage?(a.$renderContainer.prepend(n),a.$mousetrap=a.$renderContainer.find(".zoom-box-mousetrap")):(a.$oimage.before(n),a.$mousetrap=a.$oimageContainer.find(".zoom-box-mousetrap")),a.$zoombox=a.$renderContainer.find(".zoom-box-container"),a.$zoomboxImage=a.$zoombox.find(".zoom-box-image"),a.$zoomboxClose=a.$zoombox.find(".zoom-box-close"),a.$zoombox.css({position:"absolute","z-index":"90",visibility:"hidden"}),a.$zoomboxImage.css({position:"absolute","z-index":"91","max-width":"none","max-height":"none",display:"block"}),a.$zoomboxClose.css({position:"absolute","z-index":"92"}),a.$mousetrap.css({position:"absolute","z-index":"93",display:"block"}),g(a,m),a.$zoombox.css({visibility:"visible",overflow:"hidden",display:"none"}).fadeIn(m.fadeDuration),a.$zoomboxImage.on("dragstart",function(o){o.preventDefault()}),a.$mousetrap.on("mousemove",function(o){if(a.moveready){a.invert=!1,a.latency=u;var e=a.$zoombox.offset();a.mouseX=o.pageX-e.left,a.mouseY=o.pageY-e.top,p(a,m)}}).on("touchmove",function(o){if(o.preventDefault(),a.moveready){a.invert=!0,a.latency=h;var e=a.$zoombox.offset(),t=o.originalEvent.touches[0].pageX-e.left,n=o.originalEvent.touches[0].pageY-e.top,r=a.$mousetrap.width(),i=a.$mousetrap.height();0<=a.touchX&&0<=a.touchY&&(a.mouseX+=t-a.touchX,a.mouseY+=n-a.touchY,a.mouseX>r?a.mouseX=r:a.mouseX<0&&(a.mouseX=0),a.mouseY>i?a.mouseY=i:a.mouseY<0&&(a.mouseY=0),p(a,m)),a.touchX=t,a.touchY=n}}).on("mousedown",function(o){o.preventDefault();var e=a.$zoombox.offset();a.mouseDownX=o.pageX-e.left,a.mouseDownY=o.pageY-e.top}).on("mouseup",function(o){if(o.preventDefault(),m.imageClickClose){var e=a.$zoombox.offset();o.pageX-e.left<=a.mouseDownX+5&&o.pageX-e.left>=a.mouseDownX-5&&o.pageY-e.top<=a.mouseDownY+5&&o.pageY-e.top>=a.mouseDownY-5&&l(a,m)}a.mouseDownX=-999,a.mouseDownY=-999}).on("touchend",function(o){a.touchX=-999,a.touchY=-999}),a.$zoomboxClose.click(function(o){o.preventDefault(),l(a,m)}),function(o,e){var t=e.zoomSrc?e.zoomSrc:o.originalSrc;if(t){var n=new Image;n.src=t,setTimeout(function(){n.complete?c(t,n.width,n.height,o,e):n.onload=function(){c(t,this.width,this.height,o,e)}},1)}}(a,m),a.isopen=!0,"function"==typeof m.afterCreate&&m.afterCreate(m)):a.isopen=!1}(t,e),m[a].push({controllers:t,settings:e})})})}}}(e,s.extend({},r,o))}});s(window).on("resize.zoombox",function(){0==e&&(e=!0,setTimeout(function(){o(),e=!1},100))});var t=!1;s(window).on("scroll.zoombox",function(){0==t&&(o(),t=!0,setTimeout(function(){o(),t=!1},10))})}(jQuery);