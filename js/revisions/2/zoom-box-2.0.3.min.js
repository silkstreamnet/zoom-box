!function(s){var u=.4,h=1,c=.2,f=5,n={renderContainer:!1,renderOverImage:!0,renderWidth:!1,renderHeight:!1,zoomSrc:"",closeText:"",imageClickClose:!1,refreshRate:30,fadeDuration:400,onRemove:!1,afterRemove:!1,onCreate:!1,afterCreate:!1},a=0,m=[];function d(o,e,t,i,n){var r=i.$zoombox.width(),a=i.$zoombox.height();i.moveready=!0,i.naturalImgWidth=e,i.naturalImgHeight=t,i.$zoomboxImage.attr("src",o),p(i,n),i.$zoomboxImage.css("left",(r-i.$zoomboxImage.width())/2+"px"),i.$zoomboxImage.css("top",(a-i.$zoomboxImage.height())/2+"px"),i.mouseX=r/2,i.mouseY=a/2,i.$zoombox.trigger("mousemove")}function g(o,e){var t=o.attr(e);return void 0===t?"":t}function l(o,e){for(var t in n)if(n.hasOwnProperty(t)){var i=g(o,"data-"+t.toLowerCase());i&&(e[t]="false"!==i&&i)}}function p(o,e){var t=!1!==e.renderWidth?e.renderWidth:"100%",i=!1!==e.renderHeight?e.renderHeight:"100%";if(e.renderOverImage)o.$mousetrap.css({width:"100%",height:"100%"});else{var n=o.$oimage.width(),r=o.$oimage.height(),a=o.$oimage.parent().width(),m=o.$oimage.parent().height();n<a?o.$mousetrap.width(n):o.$mousetrap.width(a),r<m?o.$mousetrap.height(r):o.$mousetrap.height(m)}"string"==typeof t&&t.match(/[0-9]{1,3}%/)?o.$zoombox.css("width",t):"number"==typeof t&&o.$zoombox.width(t),"string"==typeof i&&i.match(/[0-9]{1,3}%/)?o.$zoombox.css("height",i):"number"==typeof i&&o.$zoombox.height(i);var s=o.naturalImgWidth,u=o.naturalImgHeight,h=o.$zoombox.width(),c=o.$zoombox.height(),f=s/h,d=u/c,g=s,l=u;(d<1||f<1)&&(f<d?l*=(g=h)/s:g*=(l=c)/u),o.$zoomboxImage.width(g),o.$zoomboxImage.height(l),$(o,e)}function $(o,e){!1===o.animator.timer&&function o(e,t){var i=e.timeoutSpeed,n=e.$zoombox.width(),r=e.$zoombox.height(),a=e.$zoomboxImage.width(),m=e.$zoomboxImage.height(),s=e.$zoomboxImage.position(),u=parseFloat(s.left),h=parseFloat(s.top),c=u,f=h,d=0,g=0;!1!==e.animator.timer&&(clearTimeout(e.animator.timer),e.animator.timer=!1),e.touchdrag?(d=u+e.touchDiffX,g=h+e.touchDiffY):(d=-1*e.mouseX/n*(a-n),g=-1*e.mouseY/r*(m-r));var l=a==n?0:-1*(a-n);0<d?d=0:d<l&&(d=l);var p=m==r?0:-1*(m-r);if(0<g?g=0:g<p&&(g=p),e.touchdrag)e.$zoomboxImage.css("left",d+"px"),e.$zoomboxImage.css("top",g+"px");else{var $=e.latency;if(d!=u){var v=d-u,b=(d-u)*$;v<1&&-1<v&&(b=v),c=Math.floor(10*(u+b))/10,e.$zoomboxImage.css("left",c+"px")}if(g!=h){var x=g-h,z=(g-h)*$;x<1&&-1<x&&(z=x),f=Math.floor(10*(h+z))/10,e.$zoomboxImage.css("top",f+"px")}!1!==e.animator.timer||u==d&&h==g||(e.animator.timer=setTimeout(function(){o(e,t)},i))}e.touchDiffX=0,e.touchDiffY=0}(o,e)}function v(o,e){o.isopen&&("function"==typeof e.onRemove&&e.onRemove(e),o.isopen=!1,o.$zoombox.stop(!0,!1).fadeTo(e.fadeDuration,0,function(){o.$zoombox.remove(),o.$mousetrap.remove(),!1!==o.animator.timer&&(clearTimeout(o.animator.timer),o.animator.timer=!1),o.$sobjects.attr("data-zbid",""),"function"==typeof e.afterRemove&&e.afterRemove(e)}))}function o(){for(var o in m)if(m.hasOwnProperty(o)&&m[o]&&m[o].length)for(var e=0;e<m[o].length;e++)p(m[o][e].controllers,m[o][e].settings)}var e=!(s.fn.ZoomBox=function(o){o=o||{};var e=s(this);if("string"==typeof o){var t=g(e,"data-zbid");if(t&&m[t]&&0<m[t].length)for(var i=0;i<m[t].length;i++)switch(o){default:break;case"remove":v(m[t][i].controllers,m[t][i].settings),i==m[t].length&&delete m[t]}}else{!function(n,t){if(0<n.length){var e=-1;if(n.each(function(){var o=g(s(this),"data-zbid");""!==o&&(e=parseInt(o))}),0<=e&&m[e]&&0<m[e].length)for(var o=0;o<m[e].length;o++)m[e][o].controllers.isopen||(m[e][o].controllers.$zoombox.stop(!0,!1).fadeTo(t.fadeDuration,1),m[e][o].controllers.isopen=!0);else{var r=Math.round(1e3/t.refreshRate);m[++a]=[],n.attr("data-zbid",a),n.each(function(){var o=s(this),i=s.extend({},t);l(o,i);var e=o;g(o,"src")||(e=o.find("img")),e.each(function(){var o=s(this),e=s.extend({},i);l(o,e);var t={id:a,$sobjects:n,$oimage:o,$oimageContainer:o.parent(),$renderContainer:!1,$zoombox:!1,$zoomboxImage:!1,$zoomboxClose:!1,$mousetrap:!1,originalSrc:"",renderOverImage:!1,isopen:!1,naturalImgWidth:0,naturalImgHeight:0,timeoutSpeed:r,mouseX:0,mouseY:0,mouseDownX:-999,mouseDownY:-999,touchX:!1,touchY:!1,touchDiffX:0,touchDiffY:0,invert:!1,moveready:!1,latency:.2,animator:{timer:!1,startTime:0}};!function(a,m){if(!a.isopen){"function"==typeof m.onCreate&&m.onCreate(m);var o=function(o){var e={src:"",width:0,height:0};o&&o.length&&(e.src=g(o,"src"),e.src&&(e.width=o.width(),e.height=o.height()));return e}(a.$oimage);a.islive=!1,a.originalSrc=o.src,a.naturalImgWidth=o.width,a.naturalImgHeight=o.height;var e="string"==typeof m.closeText?m.closeText:"",t='<div class="zoom-box-container"><a href="javascript:void(0);" class="zoom-box-close">'+e+'</a><img class="zoom-box-image" src="'+a.originalSrc+'" alt="" /></div>',i='<div class="zoom-box-mousetrap"></div>';a.$renderContainer=!m.renderContainer||"object"==typeof m.renderContainer&&m.renderContainer!=window?m.renderContainer:s(m.renderContainer),a.$renderContainer&&a.$renderContainer.length||(a.$renderContainer=a.$oimageContainer),a.$renderContainer&&a.$renderContainer.length&&(1<a.$renderContainer.length&&(a.$renderContainer=a.$renderContainer.eq(0)),a.$renderContainer.prepend(t),m.renderOverImage?(a.$renderContainer.prepend(i),a.$mousetrap=a.$renderContainer.find(".zoom-box-mousetrap")):(a.$oimage.before(i),a.$mousetrap=a.$oimageContainer.find(".zoom-box-mousetrap")),a.$zoombox=a.$renderContainer.find(".zoom-box-container"),a.$zoomboxImage=a.$zoombox.find(".zoom-box-image"),a.$zoomboxClose=a.$zoombox.find(".zoom-box-close"),a.$zoombox.css({position:"absolute","z-index":"90",visibility:"hidden",display:"block"}),a.$zoomboxImage.css({position:"absolute","z-index":"91","max-width":"none","max-height":"none",display:"block"}),a.$zoomboxClose.css({position:"absolute","z-index":"92"}),a.$mousetrap.css({position:"absolute","z-index":"93",display:"block"}),p(a,m),a.$zoombox.css({visibility:"visible",overflow:"hidden",opacity:0}).fadeTo(m.fadeDuration,1),a.$zoomboxImage.on("dragstart",function(o){o.preventDefault()}),a.$mousetrap.on("mousemove",function(o){if(a.moveready){a.touchdrag=!1,a.latency=u;var e=a.$zoombox.offset();a.mouseX=o.pageX-e.left,a.mouseY=o.pageY-e.top,$(a,m)}}).on("touchmove",function(o){if(o.preventDefault(),a.moveready){a.touchdrag=!0,a.latency=h;var e=a.$zoombox.offset(),t=o.originalEvent.touches[0].pageX-e.left,i=o.originalEvent.touches[0].pageY-e.top;if(!1!==a.touchX&&!1!==a.touchY){var n=a.$mousetrap.width(),r=a.$mousetrap.height();a.touchDiffX=t-a.touchX,a.touchDiffY=i-a.touchY,a.mouseX+=a.touchDiffX,a.mouseY+=a.touchDiffY,a.mouseX>n?a.mouseX=n:a.mouseX<0&&(a.mouseX=0),a.mouseY>r?a.mouseY=r:a.mouseY<0&&(a.mouseY=0),$(a,m)}a.touchX=t,a.touchY=i}}).on("mousedown",function(o){o.preventDefault();var e=a.$zoombox.offset();a.mouseDownX=o.pageX-e.left,a.mouseDownY=o.pageY-e.top,a.touchX=!1,a.touchY=!1}).on("mouseup",function(o){if(o.preventDefault(),m.imageClickClose&&a.islive){var e=a.$zoombox.offset();o.pageX-e.left<=a.mouseDownX+5&&o.pageX-e.left>=a.mouseDownX-5&&o.pageY-e.top<=a.mouseDownY+5&&o.pageY-e.top>=a.mouseDownY-5&&v(a,m)}a.mouseDownX=-999,a.mouseDownY=-999}).on("touchend",function(o){if(a.touchdrag=!0,a.latency=c,!1!==a.touchX&&!1!==a.touchY){var e=a.$mousetrap.width(),t=a.$mousetrap.height(),i=Math.abs(a.touchDiffX),n=Math.abs(a.touchDiffY);f<=i&&(a.mouseX+=a.touchDiffX*f,a.mouseX>e?a.mouseX=e:a.mouseX<0&&(a.mouseX=0)),f<=n&&(a.mouseY+=a.touchDiffY*f,a.mouseY>t?a.mouseY=t:a.mouseY<0&&(a.mouseY=0)),$(a,m)}a.touchX=!1,a.touchY=!1}),a.$zoomboxClose.click(function(o){o.preventDefault(),v(a,m)}),function(o,e){var t=e.zoomSrc?e.zoomSrc:o.originalSrc;if(t){var i=new Image;i.src=t,setTimeout(function(){i.complete?d(t,i.width,i.height,o,e):i.onload=function(){d(t,this.width,this.height,o,e)}},1)}}(a,m),a.isopen=!0,setTimeout(function(){a.islive=!0},10),"function"==typeof m.afterCreate&&m.afterCreate(m))}}(t,e),m[a].push({controllers:t,settings:e})})})}}}(e,s.extend({},n,o))}});s(window).on("resize.zoombox",function(){0==e&&(e=!0,setTimeout(function(){o(),e=!1},100))});var t=!1;s(window).on("scroll.zoombox",function(){0==t&&(o(),t=!0,setTimeout(function(){o(),t=!1},10))})}(jQuery);