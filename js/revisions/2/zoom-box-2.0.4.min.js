!function(s){var u=.4,f=1,h=.2,c=5,n={renderContainer:!1,renderOverImage:!0,renderWidth:!1,renderHeight:!1,zoomSrc:"",closeText:"",imageClickClose:!1,refreshRate:30,fadeDuration:400,onRemove:!1,afterRemove:!1,onCreate:!1,afterCreate:!1,afterImageReady:!1},a=0,d=[];function g(o,e,t,i,n){var r=i.$zoombox.width(),a=i.$zoombox.height();i.moveready=!0,i.naturalImgWidth=e,i.naturalImgHeight=t,i.$zoomboxImage.attr("src",o),p(i,n),i.$zoomboxImage.css("left",(r-i.$zoomboxImage.width())/2+"px"),i.$zoomboxImage.css("top",(a-i.$zoomboxImage.height())/2+"px"),i.mouseX=r/2,i.mouseY=a/2,i.$zoombox.trigger("mousemove"),"function"==typeof n.afterImageReady&&n.afterImageReady(n)}function l(o,e){var t=o.attr(e);return void 0===t?"":t}function m(o,e){for(var t in n)if(n.hasOwnProperty(t)){var i=l(o,"data-"+t.toLowerCase());i&&(e[t]="false"!==i&&i)}}function p(o,e){var t=!1!==e.renderWidth?e.renderWidth:"100%",i=!1!==e.renderHeight?e.renderHeight:"100%";if(e.renderOverImage)o.$mousetrap.css({width:"100%",height:"100%"});else{var n=o.$oimage.width(),r=o.$oimage.height(),a=o.$oimage.parent().width(),m=o.$oimage.parent().height();n<a?o.$mousetrap.width(n):o.$mousetrap.width(a),r<m?o.$mousetrap.height(r):o.$mousetrap.height(m)}"string"==typeof t&&t.match(/[0-9]{1,3}%/)?o.$zoombox.css("width",t):"number"==typeof t&&o.$zoombox.width(t),"string"==typeof i&&i.match(/[0-9]{1,3}%/)?o.$zoombox.css("height",i):"number"==typeof i&&o.$zoombox.height(i);var s=o.naturalImgWidth,u=o.naturalImgHeight,f=o.$zoombox.width(),h=o.$zoombox.height(),c=s/f,d=u/h,g=s,l=u;(d<1||c<1)&&(c<d?l*=(g=f)/s:g*=(l=h)/u),o.$zoomboxImage.width(g),o.$zoomboxImage.height(l),$(o,e)}function $(o,e){!1===o.animator.timer&&function o(e,t){var i=e.timeoutSpeed,n=e.$zoombox.width(),r=e.$zoombox.height(),a=e.$zoomboxImage.width(),m=e.$zoomboxImage.height(),s=e.$zoomboxImage.position(),u=parseFloat(s.left),f=parseFloat(s.top),h=u,c=f,d=0,g=0;!1!==e.animator.timer&&(clearTimeout(e.animator.timer),e.animator.timer=!1),e.touchdrag?(d=u+e.touchDiffX,g=f+e.touchDiffY):(d=-1*e.mouseX/n*(a-n),g=-1*e.mouseY/r*(m-r));var l=a==n?0:-1*(a-n);0<d?d=0:d<l&&(d=l);var p=m==r?0:-1*(m-r);if(0<g?g=0:g<p&&(g=p),e.touchdrag)e.$zoomboxImage.css("left",d+"px"),e.$zoomboxImage.css("top",g+"px");else{var $=e.latency;if(d!=u){var v=d-u,b=(d-u)*$;v<1&&-1<v&&(b=v),h=Math.floor(10*(u+b))/10,e.$zoomboxImage.css("left",h+"px")}if(g!=f){var x=g-f,z=(g-f)*$;x<1&&-1<x&&(z=x),c=Math.floor(10*(f+z))/10,e.$zoomboxImage.css("top",c+"px")}!1!==e.animator.timer||u==d&&f==g||(e.animator.timer=setTimeout(function(){o(e,t)},i))}e.touchDiffX=0,e.touchDiffY=0}(o,e)}function v(o,e){o.isopen&&("function"==typeof e.onRemove&&e.onRemove(e),o.isopen=!1,o.$zoombox.stop(!0,!1).fadeTo(e.fadeDuration,0,function(){o.$zoombox.remove(),o.$mousetrap.remove(),!1!==o.animator.timer&&(clearTimeout(o.animator.timer),o.animator.timer=!1),o.$sobjects.attr("data-zbid",""),"function"==typeof e.afterRemove&&e.afterRemove(e)}))}function o(){for(var o in d)if(d.hasOwnProperty(o)&&d[o]&&d[o].length)for(var e=0;e<d[o].length;e++)p(d[o][e].controllers,d[o][e].settings)}var e=!(s.fn.ZoomBox=function(o){o=o||{};var e=s(this);if("string"==typeof o){var t=l(e,"data-zbid");if(t&&d[t]&&0<d[t].length)for(var i=0;i<d[t].length;i++)switch(o){default:break;case"remove":v(d[t][i].controllers,d[t][i].settings),i==d[t].length&&delete d[t]}}else{!function(n,t){if(0<n.length){var e=-1;if(n.each(function(){var o=l(s(this),"data-zbid");""!==o&&(e=parseInt(o))}),0<=e&&d[e]&&0<d[e].length)for(var o=0;o<d[e].length;o++)d[e][o].controllers.isopen||(d[e][o].controllers.$zoombox.stop(!0,!1).fadeTo(t.fadeDuration,1),d[e][o].controllers.isopen=!0);else{var r=Math.round(1e3/t.refreshRate);d[++a]=[],n.attr("data-zbid",a),n.each(function(){var o=s(this),i=s.extend({},t);m(o,i);var e=o;l(o,"src")||(e=o.find("img")),e.each(function(){var o=s(this),e=s.extend({},i);m(o,e);var t={id:a,$sobjects:n,$oimage:o,$oimageContainer:o.parent(),$renderContainer:!1,$zoombox:!1,$zoomboxImage:!1,$zoomboxClose:!1,$mousetrap:!1,originalSrc:"",renderOverImage:!1,isopen:!1,naturalImgWidth:0,naturalImgHeight:0,timeoutSpeed:r,mouseX:0,mouseY:0,mouseDownX:-999,mouseDownY:-999,touchX:!1,touchY:!1,touchDiffX:0,touchDiffY:0,invert:!1,moveready:!1,latency:.2,animator:{timer:!1,startTime:0}};!function(o,a,m){if(!a.isopen){"function"==typeof m.onCreate&&m.onCreate(m);var e=function(o){var e={src:"",width:0,height:0};o&&o.length&&(e.src=l(o,"src"),e.src&&(e.width=o.width(),e.height=o.height()));return e}(a.$oimage);a.islive=!1,a.originalSrc=e.src,a.naturalImgWidth=e.width,a.naturalImgHeight=e.height;var t="string"==typeof m.closeText?m.closeText:"",i='<div class="zoom-box-container"><a href="javascript:void(0);" class="zoom-box-close">'+t+'</a><img class="zoom-box-image" src="'+a.originalSrc+'" alt="" /></div>',n='<div class="zoom-box-mousetrap"></div>';a.$renderContainer=!m.renderContainer||"object"==typeof m.renderContainer&&m.renderContainer!=window?m.renderContainer:s(m.renderContainer),a.$renderContainer&&a.$renderContainer.length||(a.$renderContainer=a.$oimageContainer),a.$renderContainer&&a.$renderContainer.length&&(1<a.$renderContainer.length&&(a.$renderContainer=a.$renderContainer.eq(0)),a.$renderContainer.prepend(i),m.renderOverImage?(a.$renderContainer.prepend(n),a.$mousetrap=a.$renderContainer.find(".zoom-box-mousetrap")):(a.$oimage.before(n),a.$mousetrap=a.$oimageContainer.find(".zoom-box-mousetrap")),a.$zoombox=a.$renderContainer.find(".zoom-box-container"),a.$zoomboxImage=a.$zoombox.find(".zoom-box-image"),a.$zoomboxClose=a.$zoombox.find(".zoom-box-close"),a.$zoombox.css({position:"absolute","z-index":"90",visibility:"hidden",display:"block"}),a.$zoomboxImage.css({position:"absolute","z-index":"91","max-width":"none","max-height":"none",display:"block"}),a.$zoomboxClose.css({position:"absolute","z-index":"92"}),a.$mousetrap.css({position:"absolute","z-index":"93",display:"block"}),p(a,m),a.$zoombox.css({visibility:"visible",overflow:"hidden",opacity:0}).fadeTo(m.fadeDuration,1),a.$zoomboxImage.on("dragstart",function(o){o.preventDefault()}),a.$mousetrap.on("mousemove",function(o){if(a.moveready){a.touchdrag=!1,a.latency=u;var e=a.$zoombox.offset();a.mouseX=o.pageX-e.left,a.mouseY=o.pageY-e.top,$(a,m)}}).on("touchmove",function(o){if(o.preventDefault(),a.moveready){a.touchdrag=!0,a.latency=f;var e=a.$zoombox.offset(),t=o.originalEvent.touches[0].pageX-e.left,i=o.originalEvent.touches[0].pageY-e.top;if(!1!==a.touchX&&!1!==a.touchY){var n=a.$mousetrap.width(),r=a.$mousetrap.height();a.touchDiffX=t-a.touchX,a.touchDiffY=i-a.touchY,a.mouseX+=a.touchDiffX,a.mouseY+=a.touchDiffY,a.mouseX>n?a.mouseX=n:a.mouseX<0&&(a.mouseX=0),a.mouseY>r?a.mouseY=r:a.mouseY<0&&(a.mouseY=0),$(a,m)}a.touchX=t,a.touchY=i}}).on("mousedown",function(o){o.preventDefault();var e=a.$zoombox.offset();a.mouseDownX=o.pageX-e.left,a.mouseDownY=o.pageY-e.top,a.touchX=!1,a.touchY=!1}).on("mouseup",function(o){if(o.preventDefault(),m.imageClickClose&&a.islive){var e=a.$zoombox.offset();o.pageX-e.left<=a.mouseDownX+5&&o.pageX-e.left>=a.mouseDownX-5&&o.pageY-e.top<=a.mouseDownY+5&&o.pageY-e.top>=a.mouseDownY-5&&v(a,m)}a.mouseDownX=-999,a.mouseDownY=-999}).on("touchend",function(o){if(a.touchdrag=!0,a.latency=h,!1!==a.touchX&&!1!==a.touchY){var e=a.$mousetrap.width(),t=a.$mousetrap.height(),i=Math.abs(a.touchDiffX),n=Math.abs(a.touchDiffY);c<=i&&(a.mouseX+=a.touchDiffX*c,a.mouseX>e?a.mouseX=e:a.mouseX<0&&(a.mouseX=0)),c<=n&&(a.mouseY+=a.touchDiffY*c,a.mouseY>t?a.mouseY=t:a.mouseY<0&&(a.mouseY=0)),$(a,m)}a.touchX=!1,a.touchY=!1}),a.$zoomboxClose.click(function(o){o.preventDefault(),v(a,m)}),function(o,e){var t=e.zoomSrc?e.zoomSrc:o.originalSrc;if(t){var i=new Image;i.src=t,setTimeout(function(){i.complete?g(t,i.width,i.height,o,e):i.onload=function(){g(t,this.width,this.height,o,e)}},1)}}(a,m),a.isopen=!0,setTimeout(function(){a.islive=!0},10),d[o].push({controllers:a,settings:m}),"function"==typeof m.afterCreate&&m.afterCreate(m))}}(a,t,e)})})}}}(e,s.extend({},n,o))}});s(window).on("resize.zoombox",function(){0==e&&(e=!0,setTimeout(function(){o(),e=!1},100))});var t=!1;s(window).on("scroll.zoombox",function(){0==t&&(o(),t=!0,setTimeout(function(){o(),t=!1},10))})}(jQuery);